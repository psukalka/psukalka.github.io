<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    
    <title>VPN | Diary Of An Observer</title>
    <meta name="viewport" content="width=device-width,minimum-scale=1">
    <meta name="description" content="We generally use VPN (Virtual Private Network) to test whether content piece is accessible from another country. Using VPN our servers are tricked as if the request is coming from another country. How does this happen ?
On a simple level, when VPN app is running on my device it will send all my requests (app or browser requests) to the VPN server that is located in some another country. VPN server will then forward these requests to the destination server. Since the request has actually come from another country, destination server will respond. This response will then be forwarded back to me. Thus VPN has acted as a middle-man or proxy to send my request.">
    <meta name="generator" content="Hugo 0.145.0">
    
    
    
      <meta name="robots" content="index, follow">
    
    

    
<link rel="stylesheet" href="/ananke/css/main.min.d05fb5f317fcf33b3a52936399bdf6f47dc776516e1692e412ec7d76f4a5faa2.css" >




    


    
      

    

    

    
      <link rel="canonical" href="http://pvsukalkar.in/tech/vpn/">
    

    <meta property="og:url" content="http://pvsukalkar.in/tech/vpn/">
  <meta property="og:site_name" content="Diary Of An Observer">
  <meta property="og:title" content="VPN">
  <meta property="og:description" content="We generally use VPN (Virtual Private Network) to test whether content piece is accessible from another country. Using VPN our servers are tricked as if the request is coming from another country. How does this happen ?
On a simple level, when VPN app is running on my device it will send all my requests (app or browser requests) to the VPN server that is located in some another country. VPN server will then forward these requests to the destination server. Since the request has actually come from another country, destination server will respond. This response will then be forwarded back to me. Thus VPN has acted as a middle-man or proxy to send my request.">
  <meta property="og:locale" content="en_us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="tech">
    <meta property="article:published_time" content="2025-07-08T18:04:41+05:30">
    <meta property="article:modified_time" content="2025-07-08T18:04:41+05:30">

  <meta itemprop="name" content="VPN">
  <meta itemprop="description" content="We generally use VPN (Virtual Private Network) to test whether content piece is accessible from another country. Using VPN our servers are tricked as if the request is coming from another country. How does this happen ?
On a simple level, when VPN app is running on my device it will send all my requests (app or browser requests) to the VPN server that is located in some another country. VPN server will then forward these requests to the destination server. Since the request has actually come from another country, destination server will respond. This response will then be forwarded back to me. Thus VPN has acted as a middle-man or proxy to send my request.">
  <meta itemprop="datePublished" content="2025-07-08T18:04:41+05:30">
  <meta itemprop="dateModified" content="2025-07-08T18:04:41+05:30">
  <meta itemprop="wordCount" content="673">
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="VPN">
  <meta name="twitter:description" content="We generally use VPN (Virtual Private Network) to test whether content piece is accessible from another country. Using VPN our servers are tricked as if the request is coming from another country. How does this happen ?
On a simple level, when VPN app is running on my device it will send all my requests (app or browser requests) to the VPN server that is located in some another country. VPN server will then forward these requests to the destination server. Since the request has actually come from another country, destination server will respond. This response will then be forwarded back to me. Thus VPN has acted as a middle-man or proxy to send my request.">

      
    
	
  </head><body class="ma0 avenir bg-near-white production">

    
   
  

  <header>
    <div class="bg-black">
      <nav class="pv3 ph3 ph4-ns" role="navigation">
  <div class="flex-l center items-center justify-between">
    <a href="/" class="f3 fw2 hover-white white-90 dib no-underline">
      
        Diary Of An Observer
      
    </a>
    <div class="flex-l items-center">
      

      
        <ul class="pl0 mr3">
          
          <li class="list f5 f4-ns fw4 dib pr3">
            <a class="hover-white white-90 no-underline" href="/" title="Home page">
              Home
            </a>
          </li>
          
          <li class="list f5 f4-ns fw4 dib pr3">
            <a class="hover-white white-90 no-underline" href="/tech/" title="Tech page">
              Tech
            </a>
          </li>
          
          <li class="list f5 f4-ns fw4 dib pr3">
            <a class="hover-white white-90 no-underline" href="/finance/" title="Finance page">
              Finance
            </a>
          </li>
          
          <li class="list f5 f4-ns fw4 dib pr3">
            <a class="hover-white white-90 no-underline" href="/about/" title="About Me page">
              About Me
            </a>
          </li>
          
        </ul>
      
      <div class="ananke-socials"></div>

    </div>
  </div>
</nav>

    </div>
  </header>



    <main class="pb7" role="main">
      
  
  
  <article class="flex-l mw8 center ph3 flex-wrap justify-between">
    <header class="mt4 w-100">
      <aside class="instapaper_ignoref b helvetica tracked ttu">
          
        Tech
      </aside><div id="sharing" class="mt3 ananke-socials"></div>
<h1 class="f1 athelas mt3 mb1">VPN</h1>
      
      
      
      <time class="f6 mv4 dib tracked" datetime="2025-07-08T18:04:41+05:30">July 8, 2025</time>
      

      
      
    </header>
    <div class="nested-copy-line-height lh-copy serif f4 nested-links mid-gray pr4-l w-two-thirds-l"><p>We generally use VPN (Virtual Private Network) to test whether content piece is accessible from another country. Using VPN our servers are tricked as if the request is coming from another country. How does this happen ?</p>
<p>On a simple level, when VPN app is running on my device it will send all my requests (app or browser requests) to the VPN server that is located in some another country. VPN server will then forward these requests to the destination server. Since the request has actually come from another country, destination server will respond. This response will then be forwarded back to me. Thus VPN has acted as a middle-man or proxy to send my request.</p>
<p>So, is VPN server just a proxy that redirects my requests ? If I install Nginx then will it be a VPN server ? Not really. Even though on a high level what they are doing is similar the way they do it is entirely different. NGINX operates at layer 7 (i.e. application layer) protocols like HTTP, HTTPS, &hellip; while VPN acts at layer 2 (Data Link Layer) or layer 3 (IP layer / network layer). In simple terms, NGINX can route packets based on request paths but VPN operates at IP address layer. It modifies IP address of packet and encrypts the content. It doesn&rsquo;t matter to VPN whether it is TCP (layer 4 packet), HTTP or websocket or any packet. It will operate at even lower layer and has control to change its IP address.</p>
<p>So, if I start VPN on my linux machine and make some request from browser, then VPN client captures the packet, modifies its IP address, encrypts the contents (so that ISP or anyone can&rsquo;t sniff into it) and sends it to VPN server. VPN server then decrypts the packet, reads the original destination, attaches that destination IP on the packet and forwards it to the destination server. The destination server sees that the packet is valid and it responds. The response is received by VPN server. It again encrypts and forwards the response to my machine where it is finally received and decrypted. Interesting.</p>
<p>But how is the VPN client able to take control of packets ? If I want to make my VPN client how can I make it ?</p>
<p>First, the VPN client creates a virtual network interface. Then directs all the traffic to this interface. Once the VPN program receies packet it then attaches VPN server IP address to it and forwards it over regular network.</p>
<p>On a Linux machine, the kernel provides <code>TUN/TAP</code> interfaces. <code>TUN</code> (Tunnel) operates at layer 3 (Netowrk layer) to handle IP packets and <code>TAP</code> (Terminal Access Point) operates at layer 2 (Data link layer) to handle ethernet frames. You can create a virtual network interface as follows:</p>
<pre tabindex="0"><code># Create TUN Interface
sudo ip tuntap add dev myvpn mode tun

# Assign it an IP address 
sudo ip addr add 10.0.0.1/24 dev myvpn

# Bring it up
sudo ip link set myvpn up 

# Redirect all traffic through this interface
sudo ip route add default dev myvpn 
</code></pre><p>You can check available network interfaces using:</p>
<pre tabindex="0"><code>ip addr show 
</code></pre><p>Route table can be checked with:</p>
<pre tabindex="0"><code>ip route show
</code></pre><p>When we create a <code>myvpn</code> network interface it creates a file descriptor at <code>/dev/net/tun</code> . You can now write C code to read this descriptor and tamper IP addresses on these packets and encryt their contents before sending it ahead. Similarly need to write decryption logic for received packets and eventually forwarding them to appropriate local port so that correct application receieves the packet. It should not happen that browser tab that was watching youtube now receieves hotstar packet.</p>
<hr>
<p>I ran the interface commands on an EC2 instance. There I saw <code>ens5</code> (main EC2 network interface), <code>lo</code> (for loopback interface that is used for inter-process communication) and <code>docker0</code> (docker bridge interface). So, when we install docker it creates a virtual network interface for inter-docker communication. I have been using it, but never thought about it until today.</p>
<ul class="pa0">
  
</ul>
<div class="mt6 instapaper_ignoref">
      
      
      </div>
    </div>

    <aside class="w-30-l mt6-l">




</aside>

  </article>

    </main>
    <footer class="bg-black bottom-0 w-100 pa3" role="contentinfo">
  <div class="flex justify-between">
  <a class="f4 fw4 hover-white white-70 dn dib-ns pv2 ph3 no-underline" href="http://pvsukalkar.in/" >
    &copy;  Diary Of An Observer 2025 
  </a>
    <div><div class="ananke-socials"></div>
</div>
  </div>
</footer>

  </body>
</html>
